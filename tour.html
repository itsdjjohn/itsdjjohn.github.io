<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-TH38FQWG');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DJ John - Tour</title>
  <meta name="description" content="Consulta las fechas de los próximos eventos de DJ John en Panamá y más allá.">
  <meta name="keywords" content="DJ John, tour, eventos, Panamá, música">
  <link rel="icon" type="image/png" href="images/favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TH38FQWG"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <div id="preloader">
    <img src="images/logo.png" alt="DJ John Logo">
  </div>
  <div id="content" style="display: none;">
    <header>
      <div class="container nav">
        <a href="index.html">
          <img src="images/logo.png" alt="DJ John Logo" />
        </a>
        <button class="menu-toggle" aria-label="Toggle menu">
          <svg viewBox="0 0 24 24">
            <path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/>
          </svg>
        </button>
        <div class="nav-links">
          <a href="index.html" data-lang-key="nav-home">Home</a>
          <a href="tour.html" data-lang-key="nav-tour">Tour</a>
          <a href="about.html" data-lang-key="nav-bio">Biografía</a>
          <a href="contact.html" data-lang-key="nav-contact">Contacto</a>
          <select id="language-select" onchange="changeLanguage()">
            <option value="es">Español</option>
            <option value="en">English</option>
          </select>
        </div>
      </div>
    </header>
    <main class="container">
      <section class="section">
        <h2 data-lang-key="tour-title">Próximos Eventos</h2>
        <div class="event-list" id="event-list"></div>
      </section>
    </main>
    <footer class="footer">
      <div class="footer-container">
        <a href="index.html">
          <img src="images/logo.png" alt="DJ John Footer Logo" class="footer-logo" loading="lazy">
        </a>
        <div class="footer-socials">
          <p class="footer-follow" data-lang-key="footer-follow">Sígueme</p>
          <a href="https://instagram.com/itsdjjohn" target="_blank" aria-label="Instagram">
            <svg viewBox="0 0 24 24" class="social-icon">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.326 3.608 1.301.975.975 1.24 2.242 1.301 3.608.058 1.265.07 1.645.07 4.849s-.012 3.584-.07 4.85c-.062 1.366-.326 2.633-1.301 3.608-.975.975-2.242 1.24-3.608 1.301-1.265.058-1.645.07-4.849.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.326-3.608-1.301-.975-.975-1.24-2.242-1.301-3.608-.058-1.265-.07-1.645-.07-4.849s.012-3.584.07-4.85c.062-1.366.326-2.633 1.301-3.608.975.975 2.242-1.24 3.608-1.301 1.265-.058 1.645-.07 4.849-.07m0-2.163c-3.259 0-3.667.014-4.947.072-1.453.066-2.944.404-4.04 1.5-1.096 1.096-1.434 2.587-1.5 4.04-.058 1.28-.072 1.688-.072 4.947s.014 3.667.072 4.947c.066 1.453.404 2.944 1.5 4.04 1.096 1.096 2.587 1.434 4.04 1.5 1.28.058 1.688.072 4.947.072s3.667-.014 4.947-.072c1.453-.066 2.944-.404 4.04-1.5 1.096-1.096 1.434-2.587 1.5-4.04.058-1.28.072-1.688.072-4.947s-.014-3.667-.072-4.947c-.066-1.453-.404-2.944-1.5-4.04-1.096-1.096-2.587-1.434-4.04-1.5-1.28-.058-1.688-.072-4.947-.072z"/>
              <path d="M12 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zm0 10.162a4 4 0 110-8 4 4 0 010 8z"/>
              <circle cx="18.406" cy="5.594" r="1.44"/>
            </svg>
          </a>
          <a href="https://facebook.com/itsdjjohn" target="_blank" aria-label="Facebook">
            <svg viewBox="0 0 24 24" class="social-icon">
              <path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24h-1.918c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.294h6.116c.731 0 1.324-.593 1.324-1.324v-21.351c0-.732-.593-1.325-1.324-1.325z"/>
            </svg>
          </a>
        </div>
        <p class="footer-copyright" data-lang-key="footer-copyright">© 2025 DJ John. Todos los derechos reservados.</p>
      </div>
    </footer>
  </div>
  <script>
    // Preloader
    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      const content = document.getElementById('content');
      preloader.style.display = 'none';
      content.style.display = 'block';
    });

    // Menu Toggle
    const menuToggle = document.querySelector('.menu-toggle');
    const navLinks = document.querySelector('.nav-links');
    menuToggle.addEventListener('click', function() {
      navLinks.classList.toggle('nav-active');
    });

    // Bandsintown API Integration
    const appId = '6ddc274027f79a574321428def39a357';
    const artistName = 'DJ John';
    const eventList = document.getElementById('event-list');

    async function fetchEvents() {
      try {
        const response = await fetch(`https://rest.bandsintown.com/artists/${encodeURIComponent(artistName)}/events?app_id=${appId}`);
        const events = await response.json();
        if (events.length === 0) {
          eventList.innerHTML = '<p class="event-error">No hay eventos próximos.</p>';
          return;
        }
        eventList.innerHTML = events.map((event, index) => `
          <div class="event-item" style="animation-delay: ${index * 0.1}s">
            <div class="event-info">
              <h3>${event.title}</h3>
              <p><strong>Fecha:</strong> ${new Date(event.datetime).toLocaleDateString('es-ES', { dateStyle: 'medium' })}</p>
              <p><strong>Lugar:</strong> ${event.venue.location || 'Ubicación no disponible'}</p>
            </div>
            <div class="event-buttons">
              <a href="#" class="btn-primary" data-event-id="${event.id}">Ver Detalles</a>
            </div>
          </div>
        `).join('');
        // Add click event listeners to event buttons
        document.querySelectorAll('.event-item .btn-primary').forEach(button => {
          button.addEventListener('click', (e) => {
            e.preventDefault();
            const eventId = button.getAttribute('data-event-id');
            createEventPage(eventId);
          });
        });
      } catch (error) {
        console.error('Error fetching events:', error);
        eventList.innerHTML = '<p class="event-error">Error al cargar los eventos.</p>';
      }
    }

    async function createEventPage(eventId) {
      try {
        const response = await fetch(`https://rest.bandsintown.com/events/${eventId}?app_id=${appId}`);
        const event = await response.json();
        // Create a new window with the event details
        const eventWindow = window.open('', '_blank');
        eventWindow.document.write(`
          <!DOCTYPE html>
          <html lang="es">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>${event.title}</title>
            <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="css/styles.css">
            <style>
              .event-details {
                max-width: 800px;
                margin: 40px auto;
                padding: 20px;
                background: #1a1a1a;
                border: 1px solid #333;
                border-radius: 10px;
                animation: fadeInUp 0.5s ease forwards;
              }
              .event-details h1 {
                font-size: 2rem;
                color: #ff1a1a;
                margin-bottom: 20px;
                text-align: center;
                font-family: 'Montserrat', sans-serif;
                font-weight: 700;
              }
              .event-details p {
                font-family: 'Poppins', sans-serif;
                font-size: 1.1rem;
                color: #ccc;
                margin-bottom: 15px;
                line-height: 1.6;
              }
              .event-details .btn-primary {
                display: inline-block;
                text-align: center;
              }
            </style>
          </head>
          <body>
            <div class="container">
              <div class="event-details">
                <h1>${event.title}</h1>
                <p><strong>Fecha:</strong> ${new Date(event.datetime).toLocaleDateString('es-ES', { dateStyle: 'medium', timeStyle: 'short' })}</p>
                <p><strong>Lugar:</strong> ${event.venue.location || 'Ubicación no disponible'}</p>
                ${event.offers && event.offers.length > 0 ? `
                  <a href="${event.offers[0].url}" target="_blank" class="btn-primary">Adquirir Entradas</a>
                ` : `
                  <a href="${event.url}&trigger=notify_me" target="_blank" class="btn-primary">Notificarme</a>
                `}
              </div>
            </div>
          </body>
          </html>
        `);
      } catch (error) {
        console.error('Error fetching event details:', error);
        alert('Error al cargar los detalles del evento.');
      }
    }

    // Language Switcher
    const translations = {
      es: {
        'nav-home': 'Home',
        'nav-tour': 'Tour',
        'nav-bio': 'Biografía',
        'nav-contact': 'Contacto',
        'tour-title': 'Próximos Eventos',
        'footer-follow': 'Sígueme',
        'footer-copyright': '© 2025 DJ John. Todos los derechos reservados.'
      },
      en: {
        'nav-home': 'Home',
        'nav-tour': 'Tour',
        'nav-bio': 'Biography',
        'nav-contact': 'Contact',
        'tour-title': 'Upcoming Events',
        'footer-follow': 'Follow Me',
        'footer-copyright': '© 2025 DJ John. All rights reserved.'
      }
    };

    function changeLanguage() {
      const lang = document.getElementById('language-select').value;
      document.querySelectorAll('[data-lang-key]').forEach(element => {
        const key = element.getAttribute('data-lang-key');
        element.textContent = translations[lang][key];
      });
    }

    // Initialize
    fetchEvents();
    changeLanguage();
  </script>
</body>
</html>